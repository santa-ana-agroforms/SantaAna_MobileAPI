digraph "Flujo_de_Escalacion_SLA" {

  rankdir = TB;
  splines = ortho;
  fontname = "Inconsolata";

  node [shape = box, style = "rounded,filled", fillcolor = "#EFF6FF", color = "#1E3A8A", fontname = "Inconsolata"];
  edge [color = "#0F766E", arrowsize = 0.8];

  Usuario    [label = "Usuario / Capataz\n(Reporta incidente/solicitud)"];
  SD         [label = "L1 - Service Desk (SPOC)\n• Triage y severidad\n• Reproducción básica\n• Check conectividad/versión\n• Acuse ≤ TTA"];
  InfoFalta  [shape = diamond, label = "¿Info suficiente?\n¿Impacto claro?"];
  Completar  [label = "Pedir evidencias mínimas\n• Pasos a reproducir\n• Capturas\n• Usuario / versión\n• Hora y endpoint"];
  TTRRisk    [shape = diamond, label = "¿TTR L1 en riesgo?\n(>50% consumido)"];
  EscalarL2  [shape = diamond, label = "¿Requiere cambios en prod?\n¿P1/P2?\n¿Imposible resolver en L1?"];

  L2         [label = "L2 - Soporte de Aplicaciones\nBackend/API • Móvil • BD/Infra\n• Análisis de logs/métricas\n• Reintentos/colas/flags\n• Rollback / restart controlado"];
  Third      [label = "Terceros (ISP/Cloud/DNS/MDM)\nGestión con cliente"];
  L3         [label = "L3 - Ingeniería / Desarrollo\n• Hotfix / migraciones\n• Cambios de código/esquema\n• Plan de rollback"];
  Resuelto   [label = "Resuelto\n• Validación con usuario\n• KB actualizada", fillcolor = "#DCFCE7", color = "#065F46"];
  RCA        [label = "Postmortem P1/P2\n• RCA ≤ 5 días hábiles\n• CAPA con dueños/fechas", fillcolor = "#FEF3C7", color = "#92400E"];

  // Flujo principal
  Usuario  -> SD                  [label = "Ticket"];
  SD       -> InfoFalta;
  InfoFalta -> Completar          [label = "No"];
  Completar -> SD                 [label = "Reintento"];
  InfoFalta -> TTRRisk            [label = "Sí"];
  TTRRisk  -> L2                  [label = "Sí (escalar)"];
  TTRRisk  -> SD                  [label = "No (continuar L1)"];

  // Desenlaces L1
  SD       -> Resuelto            [label = "FAQ / Bypass"];
  SD       -> EscalarL2           [label = "No resuelto"];
  EscalarL2 -> L2                 [label = "Sí"];
  EscalarL2 -> SD                 [label = "No (seguir L1)"];

  // L2
  L2       -> Resuelto            [label = "Workaround / Fix menor"];
  L2       -> L3                  [label = "Bug de código /\nTTR en riesgo"];
  L2       -> Third               [label = "Dependencia externa"];

  // L3
  L3       -> Resuelto            [label = "Hotfix / Release"];

  // Cierre y mejora
  Resuelto -> RCA                 [label = "Si P1/P2"];
}
